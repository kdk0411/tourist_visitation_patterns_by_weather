{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2024-06-14T01:16:09.457426Z", "invocation_id": "9f43dcfa-6035-4cee-83c2-8a1850253f03", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T01:15:17.862941Z", "completed_at": "2024-06-14T01:15:17.871945Z"}, {"name": "execute", "started_at": "2024-06-14T01:15:17.871945Z", "completed_at": "2024-06-14T01:15:18.680722Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.8418123722076416, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.weather_tour_dbt.dim_tourist_spot", "compiled": true, "compiled_code": "WITH  __dbt__cte__src_signgu as (\nWITH src_signgu AS (\r\n    SELECT * FROM wnsldjqja.signgu\r\n)\r\nSELECT \r\n    \"\uc2dc\uad70\uad6c\ucf54\ub4dc\" signguCode, \r\n    \"\uc2dc\ub3c4\uba85\" cityNm,\r\n    \"\uc2dc\uad70\uad6c\uba85\" signguNm\r\nFROM\r\n    src_signgu\n),  __dbt__cte__src_tourist_spot as (\nWITH src_tourist_spot AS (\r\n    SELECT * FROM wnsldjqja.tourist_spot \r\n)\r\nSELECT \r\n    \"\uad00\uad11\uc9c0\uba85\" spotName,\r\n    \"\uc2dc/\uad70/\uad6c \ucf54\ub4dc\" signguCode,\r\n    \"\ud14c\ub9c8\uba85\" thema\r\nFROM\r\n    src_tourist_spot\n),  __dbt__cte__src_korea_dept as (\nWITH src_korea_dept AS (\r\n    SELECT * FROM wnsldjqja.korea_dept\r\n)\r\nSELECT \r\n    \"\uc9c0\uc5ed\ucf54\ub4dc\" deptId, \r\n    \"\uc9c0\uc5ed\uc774\ub984\" cityNm\r\nFROM\r\n    src_korea_dept\n), sg AS (\n    SELECT\n        signguCode,\n        cityNm,\n        signguNm\n    FROM __dbt__cte__src_signgu\n), ts AS(\n    SELECT \n        spotName,\n        signguCode,\n        thema\n    FROM __dbt__cte__src_tourist_spot\n), kd AS(\n    SELECT * FROM __dbt__cte__src_korea_dept\n), tmp AS(\nSELECT\n    ts.spotName,\n    ts.thema,\n    sg.signguCode,\n    sg.cityNm,\n    sg.signguNm\nFROM ts\nLEFT JOIN sg ON ts.signguCode = sg.signguCode\n)\n\nSELECT\n    spotName,\n    thema,\n    signguCode,\n    tmp.cityNm,\n    signguNm,\n    deptId\nFROM tmp\nLEFT JOIN kd ON tmp.cityNm = kd.cityNm", "relation_name": "\"dev\".\"wnsldjqja\".\"dim_tourist_spot\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T01:15:18.709767Z", "completed_at": "2024-06-14T01:15:18.731770Z"}, {"name": "execute", "started_at": "2024-06-14T01:15:18.731770Z", "completed_at": "2024-06-14T01:15:25.485780Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 6.778010606765747, "adapter_response": {"_message": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS", "failures": null, "unique_id": "model.weather_tour_dbt.fact_tour_weather", "compiled": true, "compiled_code": "\nWITH  __dbt__cte__src_weather_api as (\nWITH src_weather_api AS (\r\n    SELECT * FROM wnsldjqja.weather_info\r\n)\r\nSELECT\r\n    spotName,\r\n    tm,\r\n    courseAreaId,\r\n    spotAreaName,\r\n    th3,\r\n    ws,\r\n    sky,\r\n    rhm,\r\n    pop\r\nFROM\r\n    src_weather_api\n),  __dbt__cte__src_signgu as (\nWITH src_signgu AS (\r\n    SELECT * FROM wnsldjqja.signgu\r\n)\r\nSELECT \r\n    \"\uc2dc\uad70\uad6c\ucf54\ub4dc\" signguCode, \r\n    \"\uc2dc\ub3c4\uba85\" cityNm,\r\n    \"\uc2dc\uad70\uad6c\uba85\" signguNm\r\nFROM\r\n    src_signgu\n),  __dbt__cte__src_tour_api as (\nWITH src_tour_api AS (\n    SELECT * FROM wnsldjqja.tourism\n), src_signgu AS(\n    SELECT * FROM __dbt__cte__src_signgu\n)\nSELECT \n    left(signguCode,5) signguCode,\n    baseYmd,\n    daywkDivNm,\n    touDivNm,\n    touNum\nFROM src_tour_api\n), src_weather_tot AS (\n    SELECT\n        a.spotName,\n        tm,\n        th3,\n        ws,\n        sky,\n        rhm,\n        pop,\n        b.signguCode,\n        b.signguNm,\n        b.cityNm\n    FROM __dbt__cte__src_weather_api a\n    LEFT JOIN \"dev\".\"wnsldjqja\".\"dim_tourist_spot\" b\n    ON a.spotName = b.spotName\n), src_tour_api AS (\n    SELECT\n        a.signguCode,\n        b.cityNm,\n        b.signguNm,\n        baseYmd,\n        daywkDivNm,\n        touDivNm,\n        touNum\n    FROM __dbt__cte__src_tour_api a\n    JOIN __dbt__cte__src_signgu b\n    ON a.signguCode = b.signguCode\n), tmp AS(\n    SELECT\n        baseYmd,\n        date_part('hour',tm) tm_hour,\n        spotName,\n        th3,\n        ws,\n        sky,\n        rhm,\n        pop,\n        daywkDivNm,\n        touNum,\n        touDivNm\n    FROM src_weather_tot a\n    JOIN src_tour_api b\n    ON CONCAT(a.cityNm,a.signguNm) = CONCAT(b.cityNm,b.signguNm)\n    AND TO_CHAR(a.tm,'YYYYMMDD') = TO_CHAR(b.baseYmd,'YYYYMMDD')\n)\nSELECT * FROM tmp\nWHERE baseYmd is not NULL\n\n    AND TO_CHAR(baseYmd,'YYYYMMDD') not in (SELECT DISTINCT TO_CHAR(baseYmd,'YYYYMMDD') from \"dev\".\"wnsldjqja\".\"fact_tour_weather\")\n", "relation_name": "\"dev\".\"wnsldjqja\".\"fact_tour_weather\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T01:15:25.492780Z", "completed_at": "2024-06-14T01:15:25.495780Z"}, {"name": "execute", "started_at": "2024-06-14T01:15:25.496785Z", "completed_at": "2024-06-14T01:15:49.995703Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 24.522949934005737, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.weather_tour_dbt.analytics_tour_weather_by_city", "compiled": true, "compiled_code": "WITH dim_tourist_spot AS (\n    SELECT * FROM \"dev\".\"wnsldjqja\".\"dim_tourist_spot\"\n), fact_tour_weather AS(\n    SELECT * FROM \"dev\".\"wnsldjqja\".\"fact_tour_weather\"\n), tmp1 AS(\n    SELECT\n        a.spotName,\n        signguNm,\n        baseYmd,\n        CASE WHEN extract('MONTH' from baseYmd) in (3,4,5) THEN 'SPRING'\n        WHEN extract('MONTH' from baseYmd) in (6,7,8) THEN 'SUMMER'\n        WHEN extract('MONTH' from baseYmd) in (9,10,11) THEN 'FALL'\n        ELSE 'WINTER'\n        END AS season,\n        tm_hour,\n        th3,\n        ws,\n        sky,\n        rhm,\n        pop,\n        daywkDivNm,\n        touNum,\n        touDivNm,\n        cityNm,\n        signguCode,\n        deptId\n    FROM fact_tour_weather a\n    LEFT JOIN dim_tourist_spot b\n    ON a.spotName = b.spotName\n)\nSELECT\n    signguCode,\n    cityNm,\n    signguNm,\n    baseYmd,\n    season,\n    tm_hour,\n    touDivNm,\n    daywkDivNm,\n    deptId,\n    AVG(touNum) touNum,\n    ROUND(AVG(th3),0) th3,\n    ROUND(AVG(ws),0) ws,\n    ROUND(AVG(sky),0) sky,\n    ROUND(AVG(rhm),0) rhm,\n    ROUND(AVG(pop),0) pop\nFROM tmp1\nGROUP BY signguCode, cityNm, signguNm, baseYmd, season, tm_hour, touDivNm, daywkDivNm, deptId", "relation_name": "\"dev\".\"wnsldjqja\".\"analytics_tour_weather_by_city\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-06-14T01:15:50.018741Z", "completed_at": "2024-06-14T01:15:50.021740Z"}, {"name": "execute", "started_at": "2024-06-14T01:15:50.021740Z", "completed_at": "2024-06-14T01:16:09.224041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 19.225605964660645, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1}, "message": "SUCCESS", "failures": null, "unique_id": "model.weather_tour_dbt.analytics_tour_weather_by_city_not_toudiv", "compiled": true, "compiled_code": "WITH analytics_tour_weather_by_city AS (\n    SELECT * FROM \"dev\".\"wnsldjqja\".\"analytics_tour_weather_by_city\"\n)\nSELECT\n    signguCode,\n    cityNm,\n    signguNm,\n    baseYmd,\n    season,\n    tm_hour,\n    daywkDivNm,\n    deptId,\n    SUM(touNum) totTouNum,\n    ROUND(AVG(th3),0) th3,\n    ROUND(AVG(ws),0) ws,\n    ROUND(AVG(sky),0) sky,\n    ROUND(AVG(rhm),0) rhm,\n    ROUND(AVG(pop),0) pop\nFROM analytics_tour_weather_by_city\nGROUP BY signguCode, cityNm, signguNm, baseYmd, season, tm_hour, daywkDivNm, deptId", "relation_name": "\"dev\".\"wnsldjqja\".\"analytics_tour_weather_by_city_not_toudiv\""}], "elapsed_time": 52.882302045822144, "args": {"invocation_command": "dbt run", "introspect": true, "enable_legacy_logger": false, "partial_parse": true, "favor_state": false, "static_parser": true, "warn_error_options": {"include": [], "exclude": []}, "project_dir": "C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt", "show_resource_report": false, "source_freshness_run_project_hooks": false, "empty": false, "printer_width": 80, "log_level_file": "debug", "partial_parse_file_diff": true, "write_json": true, "exclude": [], "print": true, "log_format": "default", "log_file_max_bytes": 10485760, "log_level": "info", "vars": {}, "send_anonymous_usage_stats": true, "populate_cache": true, "version_check": true, "cache_selected_only": false, "log_path": "C:\\Users\\skqlt\\Desktop\\develop\\docker\\weather_tour_dbt\\logs", "macro_debugging": false, "profiles_dir": "C:\\Users\\skqlt\\.dbt", "require_explicit_package_overrides_for_builtin_materializations": true, "select": [], "which": "run", "defer": false, "require_resource_names_without_spaces": false, "quiet": false, "indirect_selection": "eager", "use_colors": true, "log_format_file": "debug", "use_colors_file": true, "strict_mode": false}}